{"ast":null,"code":"import _toConsumableArray from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _defineProperty from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/src/components/albums/Album.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport \"./styles.css\";\nimport AddSong from \"./AddSong\";\nexport var Album =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Album, _Component);\n\n  function Album() {\n    var _this;\n\n    _classCallCheck(this, Album);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Album).call(this));\n\n    _this.handleInput = function (_ref) {\n      var target = _ref.target;\n\n      if (target.name === \"image\") {\n        _this.setState(_defineProperty({}, target.name, target.files[0]));\n\n        var reader = new FileReader();\n\n        reader.onloadend = function () {\n          _this.setState({\n            previewImage: reader.result\n          });\n        };\n\n        reader.readAsDataURL(target.files[0]);\n      } else {\n        _this.setState(_defineProperty({}, target.name, target.value));\n      }\n    };\n\n    _this.submitAlbumImage = function () {\n      var _this$state = _this.state,\n          album = _this$state.album,\n          image = _this$state.image;\n      var formData = new FormData();\n      formData.append(\"album_image\", image);\n      axios.put(\"http://127.0.0.1:3330/albums/\".concat(album.id, \"/photo\"), formData).then(function (res) {\n        return _this.setState({\n          previewImage: res.data.image,\n          image: \"\"\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.onDelete = function (id) {\n      var resp = window.confirm(\"Deseja realmente Excluir?\");\n      if (!resp) return;\n      axios.delete(\"http://127.0.0.1:3330/songs/\".concat(id)).then(function (res) {\n        return _this.setState(function (prev) {\n          return {\n            album: _objectSpread({}, prev.album, {\n              songs: _toConsumableArray(prev.album.songs.filter(function (song) {\n                return song.id !== id;\n              }))\n            })\n          };\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.onCreateSong = function () {\n      var _this$state2 = _this.state,\n          song = _this$state2.song,\n          album = _this$state2.album;\n      if (song === \"\") return;\n      axios.post(\"http://127.0.0.1:3330/albums/\".concat(album.id, \"/song/add\"), {\n        song: song\n      }).then(function (res) {\n        return _this.setState(function (prev) {\n          return {\n            album: _objectSpread({}, prev.album, {\n              songs: _toConsumableArray(prev.album.songs).concat([res.data])\n            }),\n            song: \"\"\n          };\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.state = {\n      album: [],\n      image: \"\",\n      previewImage: \"\",\n      song: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(Album, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var album = this.props.match.params.id;\n      axios.get(\"http://127.0.0.1:3330/albums/\".concat(album)).then(function (res) {\n        return _this2.setState({\n          album: res.data\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var image = this.state.image;\n\n      if (image !== \"\") {\n        if (window.confirm(\"Deseja salvar as alterações?\")) this.submitAlbumImage();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state3 = this.state,\n          album = _this$state3.album,\n          image = _this$state3.image,\n          previewImage = _this$state3.previewImage,\n          song = _this$state3.song;\n      console.log(album);\n      var loadImage = previewImage ? previewImage : album.image;\n      return React.createElement(\"div\", {\n        className: \"box p-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, \"Detalhes do Album (\", album.name, \")\", \" \", React.createElement(\"small\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, \"Voltar\"))), album && React.createElement(\"img\", {\n        className: \"image\",\n        src: album.imagem,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column-img mg-r\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"image\",\n        src: loadImage,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"column-song\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(AddSong, {\n        handleInput: this.handleInput,\n        onCreateSong: this.onCreateSong,\n        song: song,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }), album.songs ? album.songs.map(function (song, idx) {\n        return React.createElement(\"div\", {\n          class: \"key\",\n          key: song.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }, idx + 1, \". \", song.name), React.createElement(\"span\", {\n          className: \"icon has-text-danger\",\n          onClick: function onClick() {\n            return _this3.onDelete(song.id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fas fa-trash-alt\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        })));\n      }) : null)), React.createElement(\"div\", {\n        className: \"fileForm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"file control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"file-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"file-input\",\n        type: \"file\",\n        name: \"image\",\n        onChange: this.handleInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }), React.createElement(\"span\", {\n        className: \"file-cta\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"file-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fas fa-upload\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"file-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"Escolher imagem...\")), React.createElement(\"span\", {\n        className: \"file-name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, image.name !== undefined ? image.name : \"Sem imagem\"))), React.createElement(\"button\", {\n        className: \"button is-info control\",\n        onClick: this.submitAlbumImage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, \"Atualizar\")));\n    }\n  }]);\n\n  return Album;\n}(Component);\nexport default Album;","map":{"version":3,"sources":["/home/elen/Documentos/LinguagemdeProgramacao2/seminario-4/album-music-react/src/components/albums/Album.js"],"names":["React","Component","axios","Link","AddSong","Album","handleInput","target","name","setState","files","reader","FileReader","onloadend","previewImage","result","readAsDataURL","value","submitAlbumImage","state","album","image","formData","FormData","append","put","id","then","res","data","catch","err","console","log","onDelete","resp","window","confirm","delete","prev","songs","filter","song","onCreateSong","post","props","match","params","get","loadImage","imagem","map","idx","undefined"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport \"./styles.css\";\n\nimport AddSong from \"./AddSong\";\n\nexport class Album extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      album: [],\n      image: \"\",\n      previewImage: \"\",\n      song: \"\",\n    };\n  }\n\n  handleInput = ({ target }) => {\n    if (target.name === \"image\") {\n      this.setState({ [target.name]: target.files[0] });\n\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        this.setState({\n          previewImage: reader.result,\n        });\n      };\n\n      reader.readAsDataURL(target.files[0]);\n    } else {\n      this.setState({ [target.name]: target.value });\n    }\n  };\n\n  submitAlbumImage = () => {\n    const { album, image } = this.state;\n\n    const formData = new FormData();\n    formData.append(\"album_image\", image);\n\n    axios\n      .put(`http://127.0.0.1:3330/albums/${album.id}/photo`, formData)\n      .then((res) => this.setState({ previewImage: res.data.image, image: \"\" }))\n      .catch((err) => console.log(err));\n  };\n\n  onDelete = (id) => {\n    let resp = window.confirm(\"Deseja realmente Excluir?\");\n    if (!resp) return;\n    axios\n      .delete(`http://127.0.0.1:3330/songs/${id}`)\n      .then((res) =>\n        this.setState((prev) => ({\n          album: {\n            ...prev.album,\n            songs: [...prev.album.songs.filter((song) => song.id !== id)],\n          },\n        }))\n      )\n      .catch((err) => console.log(err));\n  };\n\n  onCreateSong = () => {\n    const { song, album } = this.state;\n\n    if (song === \"\") return;\n\n    axios\n      .post(`http://127.0.0.1:3330/albums/${album.id}/song/add`, { song })\n      .then((res) =>\n        this.setState((prev) => ({\n          album: {\n            ...prev.album,\n            songs: [...prev.album.songs, res.data],\n          },\n          song: \"\",\n        }))\n      )\n      .catch((err) => console.log(err));\n  };\n\n  componentDidMount() {\n    const album = this.props.match.params.id;\n    axios\n      .get(`http://127.0.0.1:3330/albums/${album}`)\n      .then((res) => this.setState({ album: res.data }))\n      .catch((err) => console.log(err));\n  }\n\n  componentWillUnmount() {\n    const { image } = this.state;\n\n    if (image !== \"\") {\n      if (window.confirm(\"Deseja salvar as alterações?\"))\n        this.submitAlbumImage();\n    }\n  }\n\n  render() {\n    const { album, image, previewImage, song } = this.state;\n\n    console.log(album);\n\n    let loadImage = previewImage ? previewImage : album.image;\n\n    return (\n      <div className=\"box p-4\">\n        <h1 className=\"title\">\n          Detalhes do Album ({album.name}){\" \"}\n          <small>\n            <Link to=\"/\">Voltar</Link>\n          </small>\n        </h1>\n        {album && <img className=\"image\" src={album.imagem} alt=\"\" />}\n\n        <div className=\"columns\">\n          <div className=\"column-img mg-r\">\n            <img className=\"image\" src={loadImage} alt=\"\" />\n            <br />\n\n          </div>\n          <div className=\"column-song\">\n            <AddSong\n              handleInput={this.handleInput}\n              onCreateSong={this.onCreateSong}\n              song={song}\n            />\n            {album.songs\n              ? album.songs.map((song, idx) => (\n                <div class=\"key\" key={song.id}>\n                  <p>\n                    {idx + 1}. {song.name}</p>\n                  <span\n                    className=\"icon has-text-danger\"\n                    onClick={() => this.onDelete(song.id)}\n                  >\n                    <i className=\"fas fa-trash-alt\" />\n                  </span>\n                </div>\n              ))\n              : null}\n          </div>\n        </div>\n        <div className=\"fileForm\">\n          <div className=\"file control\">\n            <label className=\"file-label\">\n              <input\n                className=\"file-input\"\n                type=\"file\"\n                name=\"image\"\n                onChange={this.handleInput}\n              />\n              <span className=\"file-cta\">\n                <span className=\"file-icon\">\n                  <i className=\"fas fa-upload\" />\n                </span>\n                <div className=\"file-label\">Escolher imagem...</div>\n              </span>\n              <span className=\"file-name\">\n                {image.name !== undefined ? image.name : \"Sem imagem\"}\n              </span>\n            </label>\n          </div>\n\n          <button\n            className=\"button is-info control\"\n            onClick={this.submitAlbumImage}\n          >\n            Atualizar\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Album;\n"]},"metadata":{},"sourceType":"module"}